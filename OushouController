using UnityEngine;

public class OushouController : MonoBehaviour
{
    public GameObject KomaLine;
    public GameObject UpYajirushi;
    public GameObject RightUpYajirushi;
    public GameObject LeftUpYajirushi;
    public GameObject DownYajirushi;
    public GameObject RightDownYajirushi;
    public GameObject LeftDownYajirushi;
    public GameObject RightYajirushi;
    public GameObject LeftYajirushi;
    
    private Rigidbody2D rb;
    private GameObject currentKomaLine;
    private GameObject currentUpYajirushi;
    private GameObject currentRightUpYajirushi;
    private GameObject currentLeftUpYajirushi;
    private GameObject currentDownYajirushi;
    private GameObject currentRightDownYajirushi;
    private GameObject currentLeftDownYajirushi;
    private GameObject currentRightYajirushi;
    private GameObject currentLeftYajirushi;
    
    bool wolkFlag = true;
    float x,y,z;


    void Start()
    {
        rb = this.GetComponent<Rigidbody2D>();
    }

    void Update()
    {
        
            if (Input.GetKey(KeyCode.Q))
            {
                
            }
            if (Input.GetKey(KeyCode.W))
            {
                
            }
            if (Input.GetKey(KeyCode.E))
            {
                
            }
            if (Input.GetKey(KeyCode.A))
            {
                
            }
            if (Input.GetKey(KeyCode.D))
            {
                
            }
            if (Input.GetKey(KeyCode.Z))
            {
                
            }
            if (Input.GetKey(KeyCode.X))
            {
                
            }
            if (Input.GetKey(KeyCode.C))
            {
                
            }
            if (Input.GetKeyDown(KeyCode.Space))
            {
                this.KeyManager();
            }
        
    }

    public void KeyManager()
    {
        //フラグの反転
        wolkFlag = !wolkFlag;
        //座標の確認
        Vector3 myPosition = transform.position;
        x = transform.position.x;
        y = transform.position.y;
        z = transform.position.z;
        Debug.Log("Space");
        if(wolkFlag == false)
        {
            //動きを止める
            rb.bodyType = RigidbodyType2D.Kinematic;
            rb.linearVelocity = Vector2.zero;
            rb.angularVelocity = 0f;
            //特殊パネルの出現
            currentKomaLine = Instantiate(KomaLine);
            currentKomaLine.transform.position = new Vector3(x,y,z);
            //矢印の出現
            currentUpYajirushi = Instantiate(UpYajirushi);
            currentUpYajirushi.transform.position = new Vector3(x,y+1f,z);

            currentRightUpYajirushi = Instantiate(RightUpYajirushi);
            currentRightUpYajirushi.transform.position = new Vector3(x+0.9f,y+0.9f,z);

            currentLeftUpYajirushi = Instantiate(LeftUpYajirushi);
            currentLeftUpYajirushi.transform.position = new Vector3(x-0.9f,y+0.9f,z);

            currentDownYajirushi = Instantiate(DownYajirushi);
            currentDownYajirushi.transform.position = new Vector3(x,y-1f,z);

            currentRightDownYajirushi = Instantiate(RightDownYajirushi);
            currentRightDownYajirushi.transform.position = new Vector3(x+0.9f,y-0.9f,z);

            currentLeftDownYajirushi = Instantiate(LeftDownYajirushi);
            currentLeftDownYajirushi.transform.position = new Vector3(x-0.9f,y-0.9f,z);

            currentRightYajirushi = Instantiate(RightYajirushi);
            currentRightYajirushi.transform.position = new Vector3(x+1f,y,z);

            currentLeftYajirushi = Instantiate(LeftYajirushi);
            currentLeftYajirushi.transform.position = new Vector3(x-1f,y,z);
        }
        else if(wolkFlag == true)
        {
            //動きの再開
            rb.bodyType = RigidbodyType2D.Dynamic;
            //ここにKomaLineを削除する処理を挿入
            if (currentKomaLine != null)
            {
                Destroy(currentKomaLine);
                currentKomaLine = null; // 削除後、参照をクリアしておく
            }

            if(currentUpYajirushi != null)
            {
                Destroy(currentUpYajirushi);
                currentUpYajirushi = null;
            }

            if(currentRightUpYajirushi != null)
            {
                Destroy(currentRightUpYajirushi);
                currentRightUpYajirushi = null;
            }

            if(currentLeftUpYajirushi != null)
            {
                Destroy(currentLeftUpYajirushi);
                currentLeftUpYajirushi = null;
            }

            if(currentDownYajirushi != null)
            {
                Destroy(currentDownYajirushi);
                currentDownYajirushi = null;
            }

            if(currentRightDownYajirushi != null)
            {
                Destroy(currentRightDownYajirushi);
                currentRightDownYajirushi = null;
            }

            if(currentLeftDownYajirushi != null)
            {
                Destroy(currentLeftDownYajirushi);
                currentLeftDownYajirushi = null;
            }

            if(currentRightYajirushi != null)
            {
                Destroy(currentRightYajirushi);
                currentRightYajirushi = null;
            }

            if(currentLeftYajirushi != null)
            {
                Destroy(currentLeftYajirushi);
                currentLeftYajirushi = null;
            }
        }
    }
}
